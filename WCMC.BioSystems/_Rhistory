library(pacman)
pacman::p_load(rcdk, RCy3, piano,RJSONIO,RCurl,stringr, ggplot2, httr,grid, png,ReporteRs,svglite, doSNOW, foreach,ggrepel,gridExtra,ape,plotrix)
human_data <- read.delim("D:/NCBI_BioSystems/human_pathways.txt", header = F, stringsAsFactors = F)
stat_res <- read.delim("C:/Users/barupal-pc/Google Drive/WCMC_Projects/ColumbiaUniversity/stat_results.txt", header = T, stringsAsFactors = F)
exp_path <- human_data[which(human_data$V2%in%stat_res$CID==T),]
exp_path[1:10,]
unique(exp_path$V1)
exp
glaydf1 <- exp_path[,1:2]
glaydf1
gstatsdirection1 <- rep(1,nrow(glaydf1))
stat_res$P_value
order(stat_res$P_value)
stat_res <- stat_res[order(stat_res$P_value),]
gstatsdirection1 <- rep(1,nrow(glaydf1))
gstatsdirection1 <- rep(1,nrow(stat_res))
gstatsdirection1 <- rep(1,nrow(stat_res))
gstatsdirection1[which(stat_res$$FoldChange<1)]   <- -1 ## on a pvalue of this threshold, how many were affected or not.
gstatsdirection1[which(stat_res$FoldChange<1)]   <- -1 ## on a pvalue of this threshold, how many were affected or not.
gstatsdirection1
names(gstatsdirection1) <- stat_res$CID
gsdf <- loadGSC(glaydf1)
gsares <- runGSA(geneLevelStats=gstatsdirection1,geneSetStat = 'fgsea', gsc=gsdf, nPerm=1000)
gsa_res <- GSAsummaryTable(gsares)
gsa_res
names(gstatsdirection1)
table(names(gstatsdirection1))
duplicate(names(gstatsdirection1))
duplicated(names(gstatsdirection1))
duplicated(names(gstatsdirection1))==TRUE
duplicated(names(gstatsdirection1))==FALSE
stat_res1 <- stat_res[duplicated(names(gstatsdirection1))==FALSE,]
gstatsdirection1 <- rep(1,nrow(stat_res1))
gstatsdirection1[which(stat_res1$FoldChange<1)]   <- -1 ## on a pvalue of this threshold, how many were affected or not.
names(gstatsdirection1) <- stat_res1$CID
gsdf <- loadGSC(glaydf1)
gsares <- runGSA(geneLevelStats=gstatsdirection1,geneSetStat = 'fgsea', gsc=gsdf, nPerm=1000)
gsa_res <- GSAsummaryTable(gsares)
gsa_res
gstatsdirection1
glaydf1 <- exp_path[,c(2,1)]
gsares <- runGSA(geneLevelStats=gstatsdirection1,geneSetStat = 'fgsea', gsc=gsdf, nPerm=1000)
gsdf <- loadGSC(glaydf1)
gsares <- runGSA(geneLevelStats=gstatsdirection1,geneSetStat = 'fgsea', gsc=gsdf, nPerm=1000)
gsa_res <- GSAsummaryTable(gsares)
lgsa_res
gsa_res
which(gsa_res$`p (dist.dir.up)`<0.05)
gsa_res$Name[which(gsa_res$`p (dist.dir.up)`<0.05)]
human_path <- read.csv("D:/NCBI_BioSystems/90909597810033510.csv", header = T, stringsAsFactors = F)
human_path$BSID
human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.up)`<0.05)]
human_path[human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.up)`<0.05)],]
human_path[human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.dn)` <0.05)],]
human_path[human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.dn)` <0.005)],]
human_path[human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.dn)` <0.01)],]
human_path[human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.dn)` <0.05)],]
human_path[human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.dn)` <0.03)],]
human_path[human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.dn)` <0.01)],]
gsa_res$`Genes (tot)`
stat_res1 <- stat_res[duplicated(names(gstatsdirection1))==FALSE,]
glaydf1 <- exp_path[,c(2,1)]
gstatsdirection1 <- rep(1,nrow(stat_res1))
gstatsdirection1[which(stat_res1$P_value<0.10)]   <- -1 ## on a pvalue of this threshold, how many were affected or not.
names(gstatsdirection1) <- stat_res1$CID
gsdf <- loadGSC(glaydf1)
gsares <- runGSA(geneLevelStats=gstatsdirection1,geneSetStat = 'fgsea', gsc=gsdf, nPerm=1000)
gsa_res <- GSAsummaryTable(gsares)
stat_res1 <- stat_res[duplicated(names(gstatsdirection1))==FALSE,]
glaydf1 <- exp_path[,c(2,1)]
gstatsdirection1 <- rep(1,nrow(stat_res1))
gstatsdirection1[which(stat_res1$P_value<0.10)]   <- -1 ## on a pvalue of this threshold, how many were affected or not.
names(gstatsdirection1) <- stat_res1$CID
gsdf <- loadGSC(glaydf1)
gsares <- runGSA(geneLevelStats=gstatsdirection1,geneSetStat = 'fgsea', gsc=gsdf, nPerm=1000)
gsa_res <- GSAsummaryTable(gsares)
human_path[human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.dn)` <0.01)],]
human_path[human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.dn)` <0.05)],]
human_path[human_path$BSID%in%gsa_res$Name[which(gsa_res$`p (dist.dir.up)` <0.05)],]
gstatsdirection1
