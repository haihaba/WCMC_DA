for(i in 1:(tot.n+length(factor_order2))){
if(!(i%%(length(factor_order1)+1)==0)){
at.x[m] = m
}
m=m+1
}
at.x = at.x[!is.na(at.x)]
text.pos.x = seq((tot.n/length(factor_order2)+1)/2,tot.n,by = tot.n/length(factor_order2))
text.pos.x = text.pos.x + 0:(length(text.pos.x)-1)
if(draw_single){
index=which(gsub(" ", "", f$`compound label`, fixed = TRUE)%in%gsub(" ", "", compoundName, fixed = TRUE))[1]
oo = index
}else{
index=1:nrow(f)
oo=1
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=terrain.colors(length(factor_order1)),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity')
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE)
if(!legend_position=='none'){
legend(legend_position,
factor_order1, fill=terrain.colors(length(factor_order1)))
}
factor_order1
boxplot(value~group1,data = data,notch=FALSE,col=terrain.colors(length(factor_order1)),
xaxt="n")
if(jitter){
stripchart(value ~ group1, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity')
axis(1,at = 1:length(factor_order1), labels = F)# x axis
text(x = 1:length(factor_order1), par("usr")[3]-0.1, labels = factor_order1, srt = 0, pos = 1, xpd = TRUE)
legend(legend_position,
c("RT-22C","TN-30C"), fill=terrain.colors(length(factor_order1)))
j
boxplot(value~group1,data = data,notch=FALSE,col=terrain.colors(length(factor_order1)),
xaxt="n")
if(jitter){
stripchart(value ~ group1, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
at.x
if(is.null(factor_order1)||is.na(factor_order1)){
factor_order1 = unique(p[[1]])
}else{
factor_order1 = strsplit(factor_order1, ",")[[1]]
}
tot.n = length(factor_order1)
m=1
at.x = vector()
for(i in 1:(tot.n+length(factor_order2))){
if(!(i%%(length(factor_order1)+1)==0)){
at.x[m] = m
}
m=m+1
}
at.x = at.x[!is.na(at.x)]
text.pos.x = 1:length(factor_order1)
if(draw_single){
index=which(gsub(" ", "", f$`compound label`, fixed = TRUE)%in%gsub(" ", "", compoundName, fixed = TRUE))[1]
oo = index
}else{
index=1:nrow(f)
oo=1
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1))
boxplot(value~group1,data = data,notch=FALSE,col=terrain.colors(length(factor_order1)),
xaxt="n")
if(jitter){
stripchart(value ~ group1, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity')
axis(1,at = 1:length(factor_order1), labels = F)# x axis
text(x = 1:length(factor_order1), par("usr")[3]-0.1, labels = factor_order1, srt = 0, pos = 1, xpd = TRUE)
legend(legend_position,
c("RT-22C","TN-30C"), fill=terrain.colors(length(factor_order1)))
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=terrain.colors(length(factor_order1)),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity')
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE)
if(!legend_position=='none'){
legend(legend_position,
factor_order1, fill=terrain.colors(length(factor_order1)))
}
if(is.null(factor_order1)||is.na(factor_order1)){
factor_order1 = unique(p[[1]])
}else{
factor_order1 = strsplit(factor_order1, ",")[[1]]
}
if(is.null(factor_order2)||is.na(factor_order2)){
factor_order2 = unique(p[[2]])
}else{
factor_order2 = strsplit(factor_order2, ",")[[1]]
}
tot.n = length(factor_order1)*length(factor_order2)
m=1
at.x = vector()
for(i in 1:(tot.n+length(factor_order2))){
if(!(i%%(length(factor_order1)+1)==0)){
at.x[m] = m
}
m=m+1
}
at.x = at.x[!is.na(at.x)]
text.pos.x = seq((tot.n/length(factor_order2)+1)/2,tot.n,by = tot.n/length(factor_order2))
text.pos.x = text.pos.x + 0:(length(text.pos.x)-1)
if(draw_single){
index=which(gsub(" ", "", f$`compound label`, fixed = TRUE)%in%gsub(" ", "", compoundName, fixed = TRUE))[1]
oo = index
}else{
index=1:nrow(f)
oo=1
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=terrain.colors(length(factor_order1)),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity')
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE)
factor_order1
factor_order1 = NULL
factor_order2 = NULL
jitter = TRUE){
library(pacman)
pacman::p_load(data.table,parallel, ez, userfriendlyscience,dendextend,
colorspace,gplots,stringr)
data. = WCMC.Fansly::MetaboAnalystFormat(input,row_start = ifelse(twoway,3,2))
e = data.$e
f = data.$f
p = data.$p
if(twoway){
p = p[,c(2,3)] # this makes the group1 the first column and the group2 2nd column.
}else{
p = p[2]
}
e = as.matrix(e)
if(twoway){
xlab = paste0(colnames(p)[1], " * " ,colnames(p)[2])
}else{
xlab = colnames(p)[1]
}
if(is.null(factor_order1)||is.na(factor_order1)){
factor_order1 = unique(p[[1]])
}else{
factor_order1 = strsplit(factor_order1, ",")[[1]]
}
if(is.null(factor_order2)||is.na(factor_order2)){
factor_order2 = unique(p[[2]])
}else{
factor_order2 = strsplit(factor_order2, ",")[[1]]
}
tot.n = length(factor_order1)*length(factor_order2)
m=1
at.x = vector()
for(i in 1:(tot.n+length(factor_order2))){
if(!(i%%(length(factor_order1)+1)==0)){
at.x[m] = m
}
m=m+1
}
at.x = at.x[!is.na(at.x)]
text.pos.x = seq((tot.n/length(factor_order2)+1)/2,tot.n,by = tot.n/length(factor_order2))
text.pos.x = text.pos.x + 0:(length(text.pos.x)-1)
if(draw_single){
index=which(gsub(" ", "", f$`compound label`, fixed = TRUE)%in%gsub(" ", "", compoundName, fixed = TRUE))[1]
oo = index
}else{
index=1:nrow(f)
oo=1
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=terrain.colors(length(factor_order1)),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity')
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=terrain.colors(length(factor_order1)))
}
terrain.colors(length(factor_order1))
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity')
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=terrain.colors(length(factor_order1)))
}
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
?title
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity',cex = 2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex = 2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity',cex.main=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex = 2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity',cex.main=4)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex = 2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity',cex.main=4)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex = 2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity'cex.lab=2, cex.axis=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], sub=paste0("compound #: ", j),
xlab=xlab, ylab='intensity',cex.lab=2, cex.axis=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
text.pos.x
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.axis=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.axis=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x,cex=2)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.axis=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x,cex=2)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=20, cex.axis=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x,cex=2)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.axis=20, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x, cex.axis=2)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
?par
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x, cex.axis=2,mai=c(1,2,2,2))
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x, cex.axis=2,mai=c(1,2,2,2))
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
?par
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x, cex.axis=2,mai=c(2,2,2,2))
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x, cex.axis=2,mai=c(20,20,20,20))
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
?par
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x, cex.axis=2,mar=c(20,20,20,20))
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
data = data.frame(value = e[j,],group1 = factor(p[[1]],levels = factor_order1), group2 = factor(p[[2]],levels = factor_order2))
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x, cex.axis=2,oma=c(20,20,20,20))
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j],
xlab=xlab, ylab='intensity',cex.lab=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
boxplot(value~group1*group2,data = data,notch=FALSE,col=c('blue','green'),
xaxt="n",at = at.x, cex.axis=2)
if(jitter){
stripchart(value ~ group1*group2, vertical = TRUE, data = data,
method = "jitter", add = TRUE, pch = 20, col = 'black',at=at.x)
}
title(main=f$`compound label`[j], xlab=xlab, ylab='intensity',cex.lab=2, cex.main=4, cex.sub=2)
axis(1,at = text.pos.x, labels = F)# x axis
text(x = text.pos.x, par("usr")[3]-0.1, labels = factor_order2, srt = 0, pos = 1, xpd = TRUE,cex=2)
if(!legend_position=='none'){
legend(legend_position,
c("RT-22C","TN-30C"), fill=c('blue','green'))
}
