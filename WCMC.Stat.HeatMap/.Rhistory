(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
png(height=960)
plot(dend_col,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
png("filename.png",width=2000,height=800)
#heatmap()
dev.off()
plot(dend_col,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
dev.off()
png("filename.png",width=2000,height=800)
#heatmap()
dev.off()
plot(dend_col,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
plot(dend_col,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
?png
png(filename="filename.png",height=2000,width=800)
#heatmap()
dev.off()
plot(dend_col,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
png(filename="filename.png",height=2000,width=800)
plot(dend_col,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
dend_col <- set(dend_col, "labels_cex", 0.5)
png(filename="filename.png",height=2000,width=800)
plot(dend_col,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
png(filename = "HeatMap.png",
width = 3000, height = 800, res = 72)
gplots::heatmap.2(data_row,
main = "Heatmap for the Iris data set",
srtCol = 45,
dendrogram = "both",
Rowv = dend_row,
Colv = dend_col, # this to make sure the columns are not ordered
trace="none",
margins =c(10,10),
key.xlab = "sd",
denscol = "grey",
density.info = "density",
RowSideColors = labels_colors(dend_row), # to add nice colored strips
ColSideColors = labels_colors(dend_col), # to add nice colored strips
col = some_col_func,
colRow = labels_colors(dend_row),
labRow = labels(dend_row),
colCol = labels_colors(dend_col),
labCol = labels(dend_col),
cexCol = 1,
keysize =1
)
dev.off()
p$`sample label`
names(p)
rownames(data_row) = p$`sample index`
d_e <- dist(data_row, method = distance_method)
hc_iris_row <- hclust(d_e, method = cluster_method)
iris_species <- rev(levels(as.factor(p[[row_col]])))
dend_row <- as.dendrogram(hc_iris_row)
# order it the closest we can to the order of the observations:
dend_row <- rotate(dend_row, 1:nrow(p))
# Branch Color
dend_row <- color_branches(dend_row, k=row_branchColorNumber) #, groupLabels=iris_species)
# Label Color
labels_colors(dend_row) <-
rainbow_hcl(row_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(p[[row_col]]))[order.dendrogram(dend_row)]
)]
# Change Label
labels(dend_row) <- paste(as.character(p[[row_col]])[order.dendrogram(dend_row)],
"(",p$`sample index`,")",
sep = "")
# Hang
# dend_row <- hang.dendrogram(dend_row)
# Label Size
dend_row <- set(dend_row, "labels_cex", 1)
# plot(dend_row,
#      main = "Clustered Iris data set
#      (the labels give the true flower species)",
#      horiz =  TRUE,  nodePar = list(cex = .007))
# legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
#
# column dend.
{
if(scale){
data_col = scale(as.matrix(e))
}else{
data_col = as.matrix(e)
}
rownames(data_col) = f[[1]]
d_e <- dist(data_col, method = distance_method)
hc_iris_col <- hclust(d_e, method = cluster_method)
iris_species <- rev(levels(as.factor(p[[row_col]])))
dend_col <- as.dendrogram(hc_iris_col)
# order it the closest we can to the order of the observations:
dend_col <- rotate(dend_col, 1:nrow(f))
# Branch Color
dend_col <- color_branches(dend_col, k=col_branchColorNumber) #, groupLabels=iris_species)
# Label Color
labels_colors(dend_col) <-
rainbow_hcl(col_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(f[[col_col]]))[order.dendrogram(dend_col)]
)]
# Change Label
labels(dend_col) <- paste(as.character(f[[col_col]])[order.dendrogram(dend_col)],
"(",f[[1]],")",
sep = "")
# Hang
# dend_col <- hang.dendrogram(dend_col,0.1)
# Label Size
dend_col <- set(dend_col, "labels_cex", 0.5)
png(filename="Dendrogram_feature.png",height=2000,width=800)
plot(dend_col,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
}
# HEATMAP
some_col_func <- function(n) rev(colorspace::heat_hcl(n, c = c(80, 30), l = c(30, 90),
power = c(1/5, 1.5)))
order.dendrogram(dend_row)= 1:nrow(p)
order.dendrogram(dend_col)= 1:nrow(f)
png(filename = "HeatMap.png",
width = 3000, height = 800, res = 72)
gplots::heatmap.2(data_row,
main = "Heatmap for the Iris data set",
srtCol = 45,
dendrogram = "both",
Rowv = dend_row,
Colv = dend_col, # this to make sure the columns are not ordered
trace="none",
margins =c(10,10),
key.xlab = "sd",
denscol = "grey",
density.info = "density",
RowSideColors = labels_colors(dend_row), # to add nice colored strips
ColSideColors = labels_colors(dend_col), # to add nice colored strips
col = some_col_func,
colRow = labels_colors(dend_row),
labRow = labels(dend_row),
colCol = labels_colors(dend_col),
labCol = labels(dend_col),
cexCol = 1,
keysize =1
)
dev.off()
plot(dend_col,
main = "Clustered On Compounds",
horiz =  F,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
png(filename="Dendrogram_feature.png",height=2000,width=800)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  F,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
png(filename="Dendrogram_feature.png",height=800,width=2000)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  F,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
png(filename="Dendrogram_feature.png",height=800,width=2000,res=114)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  F,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
?png
jpeg(filename="Dendrogram_feature.jpeg",height=800,width=2000,res=114)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  F,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
jpeg(filename="Dendrogram_feature.jpeg",height=800,width=2000,res=114,
quality = 100)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  F,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
jpeg(filename="Dendrogram_feature.jpeg",height=800,width=2000,
quality = 100)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  F,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
jpeg(filename="Dendrogram_feature.jpeg",height=800,width=2000,
quality = 100, res = 300)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  F,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
?pdf
pdf(file="Dendrogram_feature.pdf",height=800,width=2000)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  F,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
pdf(file="Dendrogram_feature.pdf",height=2000,width=800)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
?pdf\
?pdf
TestChars <- function(encoding = "ISOLatin1", ...)
{
pdf(encoding = encoding, ...)
par(pty = "s")
plot(c(-1,16), c(-1,16), type = "n", xlab = "", ylab = "",
xaxs = "i", yaxs = "i")
title(paste("Centred chars in encoding", encoding))
grid(17, 17, lty = 1)
for(i in c(32:255)) {
x <- i %% 16
y <- i %/% 16
points(x, y, pch = i)
}
dev.off()
}
## there will be many warnings.
TestChars("ISOLatin2")
pdf(file="Dendrogram_feature.pdf",height=2000,width=800)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
pdf(height=2000,width=800)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
pdf()
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
pdf(height = 14)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
?>dend_col
?as.dendrogram
dend_col <- set(dend_col, "labels_cex", 0.1)
pdf(height = 14)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
?pdf
pdf(file = "Dendrogram_Sample")
plot(dend_row,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
dev.off()
pdf(file = "Dendrogram_Compound.pdf",height = 14)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
dev.off()
pdf(file = "Dendrogram_Sample.pdf")
plot(dend_row,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
dev.off()
dend_row <- set(dend_row, "labels_cex", 0.5)
pdf(file = "Dendrogram_Sample.pdf")
plot(dend_row,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
dev.off()
dend_row <- set(dend_row, "labels_cex", 0.5)
pdf(file = "Dendrogram_Sample.pdf",width = 9)
plot(dend_row,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
dev.off()
dend_row <- set(dend_row, "labels_cex", 0.3)
pdf(file = "Dendrogram_Sample.pdf")
plot(dend_row,
main = "Clustered Iris data set
(the labels give the true flower species)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
dev.off()
dend_row <- hang.dendrogram(dend_row,hang = 0.1)
# Label Size
dend_row <- set(dend_row, "labels_cex", 0.3)
pdf(file = "Dendrogram_Sample.pdf")
plot(dend_row,
main = "Clustered Samples",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
dev.off()
source('~/GitHub/WCMC_DA/WCMC.Stat.HeatMap/R/mainApp.R')
library(WCMC.Stat.HeatMap)
library(opencpu);
opencpu$browse("library/WCMC.Stat.HeatMap/www")
?color_branches
col_branchColorNumber
library(WCMC.Stat.HeatMap)
library(opencpu);
opencpu$browse("library/WCMC.Stat.HeatMap/www")
iris_species
library(WCMC.Stat.HeatMap)
library(opencpu);
opencpu$browse("library/WCMC.Stat.HeatMap/www")
# get the data_row
if(scale){
data_row = scale(t(e))
}else{
data_row = t(e)
}
rownames(data_row) = p$`sample index`
d_e <- dist(data_row, method = distance_method)
hc_iris_row <- hclust(d_e, method = cluster_method)
iris_species <- rev(levels(as.factor(p[[row_col]])))
dend_row <- as.dendrogram(hc_iris_row)
# order it the closest we can to the order of the observations:
dend_row <- rotate(dend_row, 1:nrow(p))
# Branch Color
dend_row <- color_branches(dend_row, k=row_branchColorNumber) #, groupLabels=iris_species)
# Label Color
labels_colors(dend_row) <-
rainbow_hcl(row_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(p[[row_col]]))[order.dendrogram(dend_row)]
)]
# Change Label
labels(dend_row) <- paste(as.character(p[[row_col]])[order.dendrogram(dend_row)],
"(",p$`sample index`,")",
sep = "")
# Hang
# dend_row <- hang.dendrogram(dend_row,hang = 0.1)
# Label Size
dend_row <- set(dend_row, "labels_cex", 0.3)
pdf(file = "Dendrogram_Sample.pdf")
plot(dend_row,
main = "Clustered Samples",
horiz =  TRUE,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
}
dev.off()
# column dend.
{
if(scale){
data_col = scale(as.matrix(e))
}else{
data_col = as.matrix(e)
}
rownames(data_col) = f[[1]]
d_e <- dist(data_col, method = distance_method)
hc_iris_col <- hclust(d_e, method = cluster_method)
iris_species <- rev(levels(as.factor(p[[col_col]])))
dend_col <- as.dendrogram(hc_iris_col)
# order it the closest we can to the order of the observations:
dend_col <- rotate(dend_col, 1:nrow(f))
# Branch Color
if(col_branchColorNumber==1){
dend_col <- color_branches(dend_col, k=col_branchColorNumber,col='black')
}else{
dend_col <- color_branches(dend_col, k=col_branchColorNumber)
}
# Label Color
labels_colors(dend_col) <-
rainbow_hcl(col_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(f[[col_col]]))[order.dendrogram(dend_col)]
)]
# Change Label
labels(dend_col) <- paste(as.character(f[[col_col]])[order.dendrogram(dend_col)],
"(",f[[1]],")",
sep = "")
# Hang
# dend_col <- hang.dendrogram(dend_col,0.1)
# Label Size
dend_col <- set(dend_col, "labels_cex", 0.1)
pdf(file = "Dendrogram_Compound.pdf",height = 14)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
}
dev.off()
}
# HEATMAP
some_col_func <- function(n) rev(colorspace::heat_hcl(n, c = c(80, 30), l = c(30, 90),
power = c(1/5, 1.5)))
order.dendrogram(dend_row)= 1:nrow(p)
order.dendrogram(dend_col)= 1:nrow(f)
png(filename = "HeatMap.png",
width = 3000, height = 800, res = 72)
gplots::heatmap.2(data_row,
main = "Heatmap for the Iris data set",
srtCol = 45,
dendrogram = "both",
Rowv = dend_row,
Colv = dend_col, # this to make sure the columns are not ordered
trace="none",
margins =c(10,10),
key.xlab = "sd",
denscol = "grey",
density.info = "density",
RowSideColors = labels_colors(dend_row), # to add nice colored strips
ColSideColors = labels_colors(dend_col), # to add nice colored strips
col = some_col_func,
colRow = labels_colors(dend_row),
labRow = labels(dend_row),
colCol = labels_colors(dend_col),
labCol = labels(dend_col),
cexCol = 1,
keysize =1
)
dev.off()
cut_row = data.frame(cutree(hc_iris_row,k=row_branchColorNumber))
colnames(cut_row) = paste0("Cut into ",row_branchColorNumber, " clusters")
result_row = cbind(p,cut_row)
cut_col = data.frame(cutree(hc_iris_col,k=col_branchColorNumber))
colnames(cut_col) = paste0("Cut into ",col_branchColorNumber, " clusters")
result_col = cbind(f,cut_col)
fwrite(data.table(result_row),"Dendrogram_row.csv")
fwrite(data.table(result_row),"Dendrogram_row.txt",sep = "\t")
fwrite(data.table(result_col),"Dendrogram_col.csv")
fwrite(data.table(result_col),"Dendrogram_col.txt",sep = "\t")
library(WCMC.Stat.HeatMap)
library(opencpu);
opencpu$browse("library/WCMC.Stat.HeatMap/www")
zip(zipfile = "HeatMap&Dendrogram.zip",files = c("Dendrogram_col.csv"))
library(WCMC.Stat.HeatMap)
library(opencpu);
opencpu$browse("library/WCMC.Stat.HeatMap/www")
zip(zipfile = "HeatMap&Dendrogram.zip",files = c("Dendrogram_col.csv",
"Dendrogram_Compound.pdf",
"Dendrogram_row.csv",
"Dendrogram_Sample.pdf",
"HeatMap.png"))
labels_colors(dend_col)
col_branchColorNumber
as.factor(f[[col_col]])
library(WCMC.Stat.HeatMap)
library(opencpu);
opencpu$browse("library/WCMC.Stat.HeatMap/www")
library(WCMC.Stat.HeatMap)
library(opencpu);
opencpu$browse("library/WCMC.Stat.HeatMap/www")
library(WCMC.Stat.HeatMap)
library(opencpu);
opencpu$browse("library/WCMC.Stat.HeatMap/www")
library(WCMC.Stat.HeatMap)
library(opencpu);
opencpu$browse("library/WCMC.Stat.HeatMap/www")
library(WCMC.Stat.HeatMap)
library(WCMC.Stat.HeatMap)
