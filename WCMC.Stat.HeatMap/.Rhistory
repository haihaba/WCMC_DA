key.xlab=NA,  # no xlab
key.par=list(mgp=c(1.5, 0.5, 0),
mar=c(2.5, 2.5, 1, 0)),
key.xtickfun=function() {
breaks <- parent.frame()$breaks
return(list(
at=parent.frame()$scale01(c(breaks[1],
breaks[length(breaks)])),
labels=c(as.character(breaks[1]),
as.character(breaks[length(breaks)]))
))
})
heatmap.2(x,
breaks=256,
key.title=NA,
key.xlab=NA,
key.par=list(mgp=c(1.5, 0.5, 0),
mar=c(1, 2.5, 1, 0)),
key.xtickfun=function() {
cex <- par("cex")*par("cex.axis")
side <- 1
line <- 0
col <- par("col.axis")
font <- par("font.axis")
mtext("low", side=side, at=0, adj=0,
line=line, cex=cex, col=col, font=font)
mtext("high", side=side, at=1, adj=1,
line=line, cex=cex, col=col, font=font)
return(list(labels=FALSE, tick=FALSE))
})
hv <- heatmap.2(x, col=bluered, scale="column", tracecol="#303030")
names(hv)
hv$colorTable
hv$colorTable[hv$colorTable[,"color"]=="#FFFFFF",]
whiteBin <- unlist(hv$colorTable[hv$colorTable[,"color"]=="#FFFFFF",1:2])
rbind(whiteBin[1] * hv$colSDs + hv$colMeans,
whiteBin[2] * hv$colSDs + hv$colMeans )
hv <- heatmap.2(x, col=cm.colors(255), scale="column",
RowSideColors=rc, ColSideColors=cc, margin=c(5, 10),
xlab="specification variables", ylab= "Car Models",
main="heatmap(<Mtcars data>, ..., scale=\"column\")",
tracecol="green", density="density")
hv <- heatmap.2(x, col=cm.colors(255), scale="column",
RowSideColors=rc, ColSideColors=cc, margin=c(5, 10),
xlab="specification variables", ylab= "Car Models",
main="heatmap(<Mtcars data>, ..., scale=\"column\")",
tracecol="green", density="density", colRow=rc, colCol=cc,
srtCol=45, adjCol=c(0.5,1))
data(attitude)
round(Ca <- cor(attitude), 2)
symnum(Ca) # simple graphic
heatmap.2(Ca, 		 symm=TRUE, margin=c(6, 6), trace="none" )
heatmap.2(Ca, Rowv=FALSE, symm=TRUE, margin=c(6, 6), trace="none" )
heatmap.2(x, lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(1.5, 4, 2 ) )
heatmap.2(x, lmat=rbind( c(0, 3, 4), c(2,1,0 ) ), lwid=c(1.5, 4, 2 ) )
data(USJudgeRatings)
symnum( cU <- cor(USJudgeRatings) )
hU <- heatmap.2(cU, Rowv=FALSE, symm=TRUE, col=topo.colors(16),
distfun=function(c) as.dist(1 - c), trace="none")
hM <- format(round(cU, 2))
hM
heatmap.2(cU, Rowv=FALSE, symm=TRUE, col=rev(heat.colors(16)),
distfun=function(c) as.dist(1 - c), trace="none",
cellnote=hM)
gplots::heatmap.2(data_row,
main = "A global View of Heatmap",
srtCol = 45,
dendrogram = "both",
Rowv = dend_row,
Colv = dend_col, # this to make sure the columns are not ordered
trace="none",
margins =c(10,10),
key.xlab = "sd",
denscol = "grey",
density.info = "density",
RowSideColors = labels_colors(dend_row), # to add nice colored strips
ColSideColors = labels_colors(dend_col), # to add nice colored strips
col = some_col_func,
colRow = labels_colors(dend_row),
labRow = labels(dend_row),
colCol = labels_colors(dend_col),
labCol = labels(dend_col),
cexCol = 1,
keysize =1
)
labels_colors(dend_row)
as.character(f[[col_col]])
paste(as.character(f[[col_col]])[order.dendrogram(dend_col)],
"(",f[[1]],")",
sep = "")
paste(as.character(f[[col_col]])[order.dendrogram(dend_col)],
"(",f[[1]],")",
sep = "")
distance_method = "euclidean"
minkowski_p = NULL
cluster_method = "complete"
scale_feature = T
scale_sample = T
row_col = "none"
row_branchColorNumber = 1
col_col = "none"
col_branchColorNumber = 1
e = fread("e.csv")[,-1]
f = fread("f.csv")[,-1]
p = fread("p.csv")[,-1]
if(scale_feature){
data_row = scale(t(e))
}else{
data_row = t(e)
}
rownames(data_row) = p$`sample label`
d_e <- dist(data_row, method = distance_method,p=minkowski_p)
hc_iris_row <- hclust(d_e, method = cluster_method)
iris_species <- rev(levels(as.factor(p[[row_col]])))
dend_row <- as.dendrogram(hc_iris_row)
# order it the closest we can to the order of the observations:
dend_row <- rotate(dend_row, 1:nrow(p))
# Branch Color
dend_row <- color_branches(dend_row, k=row_branchColorNumber) #, groupLabels=iris_species)
# Label Color
labels_colors(dend_row) <-
rainbow_hcl(row_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(p[[row_col]]))[order.dendrogram(dend_row)]
)]
# Change Label
labels(dend_row) <- paste(as.character(p[[row_col]])[order.dendrogram(dend_row)],
"(",p$`sample label`,")",
sep = "")
# Hang
dend_row <- hang.dendrogram(dend_row,hang = 0.1)
# Label Size
dend_row <- set(dend_row, "labels_cex", 0.3)
pdf(file = "Dendrogram_Sample.pdf")
plot(dend_row,
main = "Clustered Samples",
horiz =  TRUE,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
}
dev.off()
# Hang back
dend_row <- hang.dendrogram(dend_row,-1)
plot(dend_row,
main = "Clustered Samples",
horiz =  TRUE,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
}
dend_row <- set(dend_row, "labels_cex", 0.3)
plot(dend_row,
main = "Clustered Samples",
horiz =  TRUE,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
}
dend_row <- set(dend_row, "labels_cex", 0.3)
plot(dend_row,
main = "Clustered Samples",
horiz =  TRUE,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
}
dev.off()
plot(dend_row,
main = "Clustered Samples",
horiz =  TRUE,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
}
dend_row <- hang.dendrogram(dend_row,hang = 0.1)
if(row_branchColorNumber==1){
dend_row <- rowor_branches(dend_row, k=row_branchColorNumber,row='black')
}else{
dend_row <- rowor_branches(dend_row, k=row_branchColorNumber)
}
labels_colors(dend_row) <-
rainbow_hcl(row_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(p[[row_col]]))[order.dendrogram(dend_row)]
)]
# Change Label
labels(dend_row) <- paste(as.character(p[[row_col]])[order.dendrogram(dend_row)],
"(",p$`sample label`,")",
sep = "")
# Hang
dend_row <- hang.dendrogram(dend_row,hang = 0.1)
dend_row <- set(dend_row, "labels_cex", 0.3)
plot(dend_row,
main = "Clustered Samples",
horiz =  TRUE,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
}
# Branch Color
if(row_branchColorNumber==1){
dend_row <- color_branches(dend_row, k=row_branchColorNumber,row='black')
}else{
dend_row < color_branches(dend_row, k=row_branchColorNumber)
}
# Label Color
labels_colors(dend_row) <-
rainbow_hcl(row_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(p[[row_col]]))[order.dendrogram(dend_row)]
)]
# Change Label
labels(dend_row) <- paste(as.character(p[[row_col]])[order.dendrogram(dend_row)],
"(",p$`sample label`,")",
sep = "")
# Hang
dend_row <- hang.dendrogram(dend_row,hang = 0.1)
# Label Size
dend_row <- set(dend_row, "labels_cex", 0.3)
plot(dend_row,
main = "Clustered Samples",
horiz =  TRUE,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
}
dend_row
row_branchColorNumber
dend_row <- color_branches(dend_row, k=row_branchColorNumber,col='black')
labels_colors(dend_row) <-
rainbow_hcl(row_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(p[[row_col]]))[order.dendrogram(dend_row)]
)]
# Change Label
labels(dend_row) <- paste(as.character(p[[row_col]])[order.dendrogram(dend_row)],
"(",p$`sample label`,")",
sep = "")
# Hang
dend_row <- hang.dendrogram(dend_row,hang = 0.1)
# Label Size
dend_row <- set(dend_row, "labels_cex", 0.3)
plot(dend_row,
main = "Clustered Samples",
horiz =  TRUE,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(row_branchColorNumber))
}
as.character(p[[row_col]]
)
paste(
"(",p$`sample label`,")")
paste0("(",p$`sample label`,")")
if(length(as.character(p[[row_col]])==0)){
labels(dend_row) <- p$`sample label`
}else{
labels(dend_row) <- paste(as.character(p[[row_col]])[order.dendrogram(dend_row)],
"(",p$`sample label`,")",
sep = "")
}
gplots::heatmap.2(data_row,
main = "A global View of Heatmap",
srtCol = 45,
dendrogram = "both",
Rowv = dend_row,
Colv = dend_col, # this to make sure the columns are not ordered
trace="none",
margins =c(10,10),
key.xlab = "sd",
denscol = "grey",
density.info = "density",
RowSideColors = labels_colors(dend_row), # to add nice colored strips
ColSideColors = labels_colors(dend_col), # to add nice colored strips
col = some_col_func,
colRow = labels_colors(dend_row),
labRow = labels(dend_row),
colCol = labels_colors(dend_col),
labCol = labels(dend_col),
cexCol = 1,
keysize =1
)
paste(as.character(f[[col_col]])[order.dendrogram(dend_col)],
"(",f[[1]],")",
sep = "")
labels(dend_col) <- f[[1]]
dend_col <- hang.dendrogram(dend_col,0.1)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
}
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
}
pdf(file = "Dendrogram_Compound.pdf",height = 14)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
}
dev.off()
dend_col <- hang.dendrogram(dend_col,-1)
pdf(file = "Dendrogram_Compound.pdf",height = 14)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
}
dev.off()
dend_col <- set(dend_col, "labels_cex", 0.1)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
}
pdf(file = "Dendrogram_Compound.pdf",height = 14)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
}
dev.off()
f[[1]]
dend_col
str(dend_col)
[order.dendrogram(dend_col)]
order.dendrogram(dend_col)
if(scale_sample){
data_col = scale(as.matrix(e))
}else{
data_col = as.matrix(e)
}
rownames(data_col) = f[[1]]
d_e <- dist(data_col, method = distance_method)
hc_iris_col <- hclust(d_e, method = cluster_method)
iris_species <- rev(levels(as.factor(p[[col_col]])))
dend_col <- as.dendrogram(hc_iris_col)
dend_col
str(dend_col)
dend_col <- rotate(dend_col, 1:nrow(f))
str(dend_col)
if(col_branchColorNumber==1){
dend_col <- color_branches(dend_col, k=col_branchColorNumber,col='black')
}else{
dend_col <- color_branches(dend_col, k=col_branchColorNumber)
}
labels_colors(dend_col) <-
rainbow_hcl(col_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(f[[col_col]]))[order.dendrogram(dend_col)]
)]
str(dend_col)
col_branchColorNumber = 2
rainbow_hcl(col_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(f[[col_col]]))[order.dendrogram(dend_col)]
)]
f[[1]]
order.dendrogram(dend_col)
f[[1]][order.dendrogram(dend_col)]
str(dend_col)
f[[1]][order.dendrogram(dend_col)]
labels(dend_col) <- f[[1]][order.dendrogram(dend_col)]
# column dend.
{
if(scale_sample){
data_col = scale(as.matrix(e))
}else{
data_col = as.matrix(e)
}
rownames(data_col) = f[[1]]
d_e <- dist(data_col, method = distance_method)
hc_iris_col <- hclust(d_e, method = cluster_method)
iris_species <- rev(levels(as.factor(p[[col_col]])))
dend_col <- as.dendrogram(hc_iris_col)
# order it the closest we can to the order of the observations:
dend_col <- rotate(dend_col, 1:nrow(f))
# Branch Color
if(col_branchColorNumber==1){
dend_col <- color_branches(dend_col, k=col_branchColorNumber,col='black')
}else{
dend_col <- color_branches(dend_col, k=col_branchColorNumber)
}
# Label Color
labels_colors(dend_col) <-
rainbow_hcl(col_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(f[[col_col]]))[order.dendrogram(dend_col)]
)]
# Change Label
if(length(as.character(f[[col_col]])==0)){
labels(dend_col) <- f[[1]][order.dendrogram(dend_col)]
}else{
labels(dend_col) <- paste(as.character(f[[col_col]])[order.dendrogram(dend_col)],
"(",f[[1]][order.dendrogram(dend_col)],")",
sep = "")
}
# Hang
# dend_col <- hang.dendrogram(dend_col,0.1)
# Label Size
dend_col <- set(dend_col, "labels_cex", 0.1)
pdf(file = "Dendrogram_Compound.pdf",height = 14)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
}
dev.off()
# Hang back
# dend_col <- hang.dendrogram(dend_col,-1)
}
col_branchColorNumber
col_branchColorNumber = 1
# column dend.
{
if(scale_sample){
data_col = scale(as.matrix(e))
}else{
data_col = as.matrix(e)
}
rownames(data_col) = f[[1]]
d_e <- dist(data_col, method = distance_method)
hc_iris_col <- hclust(d_e, method = cluster_method)
iris_species <- rev(levels(as.factor(p[[col_col]])))
dend_col <- as.dendrogram(hc_iris_col)
# order it the closest we can to the order of the observations:
dend_col <- rotate(dend_col, 1:nrow(f))
# Branch Color
if(col_branchColorNumber==1){
dend_col <- color_branches(dend_col, k=col_branchColorNumber,col='black')
}else{
dend_col <- color_branches(dend_col, k=col_branchColorNumber)
}
# Label Color
labels_colors(dend_col) <-
rainbow_hcl(col_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(f[[col_col]]))[order.dendrogram(dend_col)]
)]
# Change Label
if(length(as.character(f[[col_col]])==0)){
labels(dend_col) <- f[[1]][order.dendrogram(dend_col)]
}else{
labels(dend_col) <- paste(as.character(f[[col_col]])[order.dendrogram(dend_col)],
"(",f[[1]][order.dendrogram(dend_col)],")",
sep = "")
}
# Hang
# dend_col <- hang.dendrogram(dend_col,0.1)
# Label Size
dend_col <- set(dend_col, "labels_cex", 0.1)
pdf(file = "Dendrogram_Compound.pdf",height = 14)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
}
dev.off()
# Hang back
# dend_col <- hang.dendrogram(dend_col,-1)
}
length(as.character(f[[col_col]])==0)
f[[1]][order.dendrogram(dend_col)]
# column dend.
{
if(scale_sample){
data_col = scale(as.matrix(e))
}else{
data_col = as.matrix(e)
}
rownames(data_col) = f[[1]]
d_e <- dist(data_col, method = distance_method)
hc_iris_col <- hclust(d_e, method = cluster_method)
iris_species <- rev(levels(as.factor(p[[col_col]])))
dend_col <- as.dendrogram(hc_iris_col)
# order it the closest we can to the order of the observations:
dend_col <- rotate(dend_col, 1:nrow(f))
# Branch Color
if(col_branchColorNumber==1){
dend_col <- color_branches(dend_col, k=col_branchColorNumber,col='black')
}else{
dend_col <- color_branches(dend_col, k=col_branchColorNumber)
}
# Label Color
labels_colors(dend_col) <-
rainbow_hcl(col_branchColorNumber)[sort_levels_values(
as.numeric(as.factor(f[[col_col]]))[order.dendrogram(dend_col)]
)]
# Change Label
if(length(as.character(f[[col_col]]))==0){
labels(dend_col) <- f[[1]][order.dendrogram(dend_col)]
}else{
labels(dend_col) <- paste(as.character(f[[col_col]])[order.dendrogram(dend_col)],
"(",f[[1]][order.dendrogram(dend_col)],")",
sep = "")
}
# Hang
# dend_col <- hang.dendrogram(dend_col,0.1)
# Label Size
dend_col <- set(dend_col, "labels_cex", 0.1)
pdf(file = "Dendrogram_Compound.pdf",height = 14)
plot(dend_col,
main = "Clustered On Compounds",
horiz =  T,  nodePar = list(cex = .007))
if(!length(iris_species)==0){
legend("topleft", legend = iris_species, fill = rainbow_hcl(col_branchColorNumber))
}
dev.off()
# Hang back
# dend_col <- hang.dendrogram(dend_col,-1)
}
?hclust
library(WCMC.Stat.HeatMap)
library(opencpu);
opencpu$browse("library/WCMC.Stat.HeatMap/www")
library(WCMC.Stat.HeatMap)
